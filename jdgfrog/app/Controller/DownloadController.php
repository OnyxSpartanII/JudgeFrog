<?php
class DownloadController extends AppController {
	public $name = 'Download';
	public $uses = array('Datum');
	public $helpers = array('Html', 'Form');
	public function beforeFilter() {
		parent::beforeFilter();
		$this->Auth->allow('download');
	}
	public function download() {
		if ($this->request->is('post')) {
				// echo 'Account created!';
			$allData = $this->Datum->find('all', array(
					'fields' => array(
						'Datum.CaseDefId',
						'Datum.id',
						'Datum.DefLast',
						'Datum.DefFirst',
						'Datum.Alias',
						'Datum.CaseNam',
						'Datum.CaseNum',
						'Datum.NumDef',
						'Datum.State',
						'Datum.FedDistrictLoc',
						'Datum.FedDistrictNum',
						'Datum.JudgeName',
						'Datum.JudgeRace',
						'Datum.JudgeGen',
						'Datum.JudgeTenure',
						'Datum.JudgeApptBy',
						'Datum.CaseSummary',
						'Datum.DefGender',
						'Datum.DefRace',
						'Datum.DefBirthdate',
						'Datum.DefArrestAge',
						'Datum.ChargeDate',
						'Datum.ArrestDate',
						'Datum.Detained',
						'Datum.BailType',
						'Datum.BailAmount',
						'Datum.LaborTraf',
						'Datum.AdultSexTraf',
						'Datum.MinorSexTraf',
						'Datum.FelCharged',
						'Datum.FelSentenced',

						'Datum.S1961to1968',
						'Datum.Counts1961to1968',
						'Datum.CountsNP1961to1968',
						'Datum.PleaDismissed1961to1968',
						'Datum.PleaGuilty1961to1968',
						'Datum.TrialGuilty1961to1968',
						'Datum.TrialNG1961to1968',
						'Datum.Fines1961to1968',
						'Datum.Sent1961to1968',
						'Datum.Prob1961to1968',

						'Datum.S1028',
						'Datum.Counts1028',
						'Datum.CountsNP1028',
						'Datum.PleaDismissed1028',
						'Datum.PleaGuilty1028',
						'Datum.TrialGuilty1028',
						'Datum.TrialNG1028',
						'Datum.Fines1028',
						'Datum.Sent1028',
						'Datum.Prob1028',

						'Datum.S1351',
						'Datum.Counts1351',
						'Datum.CountsNP1351',
						'Datum.PleaDismissed1351',
						'Datum.PleaGuilty1351',
						'Datum.TrialGuilty1351',
						'Datum.TrialNG1351',
						'Datum.Fines1351',
						'Datum.Sent1351',
						'Datum.Prob1351',

						'Datum.S1425',
						'Datum.Counts1425',
						'Datum.CountsNP1425',
						'Datum.PleaDismissed1425',
						'Datum.PleaGuilty1425',
						'Datum.TrialGuilty1425',
						'Datum.TrialNG1425',
						'Datum.Fines1425',
						'Datum.Sent1425',
						'Datum.Prob1425',

						'Datum.S1512',
						'Datum.Counts1512',
						'Datum.CountsNP1512',
						'Datum.PleaDismissed1512',
						'Datum.PleaGuilty1512',
						'Datum.TrialGuilty1512',
						'Datum.TrialNG1512',
						'Datum.Fines1512',
						'Datum.Sent1512',
						'Datum.Prob1512',

						'Datum.S1546',
						'Datum.Counts1546',
						'Datum.CountsNP1546',
						'Datum.PleaDismissed1546',
						'Datum.PleaGuilty1546',
						'Datum.TrialGuilty1546',
						'Datum.TrialNG1546',
						'Datum.Fines1546',
						'Datum.Sent1546',
						'Datum.Prob1546',
						
						'Datum.S1581to1588',
						'Datum.Counts1581to1588',
						'Datum.CountsNP1581to1588',
						'Datum.PleaDismissed1581to1588',
						'Datum.PleaGuilty1581to1588',
						'Datum.TrialGuilty1581to1588',
						'Datum.TrialNG1581to1588',
						'Datum.Fines1581to1588',
						'Datum.Sent1581to1588',
						'Datum.Prob1581to1588',
						
						'Datum.S1589',
						'Datum.Counts1589',
						'Datum.CountsNP1589',
						'Datum.PleaDismissed1589',
						'Datum.PleaGuilty1589',
						'Datum.TrialGuilty1589',
						'Datum.TrialNG1589',
						'Datum.Fines1589',
						'Datum.Sent1589',
						'Datum.Prob1589',
						
						'Datum.S1590',
						'Datum.Counts1590',
						'Datum.CountsNP1590',
						'Datum.PleaDismissed1590',
						'Datum.PleaGuilty1590',
						'Datum.TrialGuilty1590',
						'Datum.TrialNG1590',
						'Datum.Fines1590',
						'Datum.Sent1590',
						'Datum.Prob1590',
						
						'Datum.S1591',
						'Datum.Counts1591',
						'Datum.CountsNP1591',
						'Datum.PleaDismissed1591',
						'Datum.PleaGuilty1591',
						'Datum.TrialGuilty1591',
						'Datum.TrialNG1591',
						'Datum.Fines1591',
						'Datum.Sent1591',
						'Datum.Prob1591',
						
						'Datum.S1592',
						'Datum.Counts1592',
						'Datum.CountsNP1592',
						'Datum.PleaDismissed1592',
						'Datum.PleaGuilty1592',
						'Datum.TrialGuilty1592',
						'Datum.TrialNG1592',
						'Datum.Fines1592',
						'Datum.Sent1592',
						'Datum.Prob1592',
						
						'Datum.S2252',
						'Datum.Counts2252',
						'Datum.CountsNP2252',
						'Datum.PleaDismissed2252',
						'Datum.PleaGuilty2252',
						'Datum.TrialGuilty2252',
						'Datum.TrialNG2252',
						'Datum.Fines2252',
						'Datum.Sent2252',
						'Datum.Prob2252',
						
						'Datum.S2260',
						'Datum.Counts2260',
						'Datum.CountsNP2260',
						'Datum.PleaDismissed2260',
						'Datum.PleaGuilty2260',
						'Datum.TrialGuilty2260',
						'Datum.TrialNG2260',
						'Datum.Fines2260',
						'Datum.Sent2260',
						'Datum.Prob2260',
						
						'Datum.S2421to2424',
						'Datum.Counts2421to2424',
						'Datum.CountsNP2421to2424',
						'Datum.PleaDismissed2421to2424',
						'Datum.PleaGuilty2421to2424',
						'Datum.TrialGuilty2421to2424',
						'Datum.TrialNG2421to2424',
						'Datum.Fines2421to2424',
						'Datum.Sent2421to2424',
						'Datum.Prob2421to2424',
						
						'Datum.S1324',
						'Datum.Counts1324',
						'Datum.CountsNP1324',
						'Datum.PleaDismissed1324',
						'Datum.PleaGuilty1324',
						'Datum.TrialGuilty1324',
						'Datum.TrialNG1324',
						'Datum.Fines1324',
						'Datum.Sent1324',
						'Datum.Prob1324',
						
						'Datum.S1328',
						'Datum.Counts1328',
						'Datum.CountsNP1328',
						'Datum.PleaDismissed1328',
						'Datum.PleaGuilty1328',
						'Datum.TrialGuilty1328',
						'Datum.TrialNG1328',
						'Datum.Fines1328',
						'Datum.Sent1328',
						'Datum.Prob1328',

						'Datum.DateTerm',
						'Datum.SentDate',
						'Datum.TotalSentence',
						'Datum.Restitution',
						'Datum.AssetForfeit',
						'Datum.SupRelease',
						'Datum.Probation',
						'Datum.NumVic',
						'Datum.NumVicMinor',
						'Datum.NumVicForeign',
						'Datum.NumVicFemale',
						'Datum.OCName1',
						'Datum.OCType1',
						'Datum.OCRace1',
						'Datum.OCScope1',
						'Datum.OCName2',
						'Datum.OCType2',
						'Datum.OCRace2',
						'Datum.OCScope2'
					),
					'order' => array(
						'Datum.CaseDefId',
						'Datum.id',
						'Datum.DefLast',
						'Datum.DefFirst',
						'Datum.Alias',
						'Datum.CaseNam',
						'Datum.CaseNum',
						'Datum.NumDef',
						'Datum.State',
						'Datum.FedDistrictLoc',
						'Datum.FedDistrictNum',
						'Datum.JudgeName',
						'Datum.JudgeRace',
						'Datum.JudgeGen',
						'Datum.JudgeTenure',
						'Datum.JudgeApptBy',
						'Datum.CaseSummary',
						'Datum.DefGender',
						'Datum.DefRace',
						'Datum.DefBirthdate',
						'Datum.DefArrestAge',
						'Datum.ChargeDate',
						'Datum.ArrestDate',
						'Datum.Detained',
						'Datum.BailType',
						'Datum.BailAmount',
						'Datum.LaborTraf',
						'Datum.AdultSexTraf',
						'Datum.MinorSexTraf',
						'Datum.FelCharged',
						'Datum.FelSentenced',

						'Datum.S1961to1968',
						'Datum.Counts1961to1968',
						'Datum.CountsNP1961to1968',
						'Datum.PleaDismissed1961to1968',
						'Datum.PleaGuilty1961to1968',
						'Datum.TrialGuilty1961to1968',
						'Datum.TrialNG1961to1968',
						'Datum.Fines1961to1968',
						'Datum.Sent1961to1968',
						'Datum.Prob1961to1968',

						'Datum.S1028',
						'Datum.Counts1028',
						'Datum.CountsNP1028',
						'Datum.PleaDismissed1028',
						'Datum.PleaGuilty1028',
						'Datum.TrialGuilty1028',
						'Datum.TrialNG1028',
						'Datum.Fines1028',
						'Datum.Sent1028',
						'Datum.Prob1028',

						'Datum.S1351',
						'Datum.Counts1351',
						'Datum.CountsNP1351',
						'Datum.PleaDismissed1351',
						'Datum.PleaGuilty1351',
						'Datum.TrialGuilty1351',
						'Datum.TrialNG1351',
						'Datum.Fines1351',
						'Datum.Sent1351',
						'Datum.Prob1351',

						'Datum.S1425',
						'Datum.Counts1425',
						'Datum.CountsNP1425',
						'Datum.PleaDismissed1425',
						'Datum.PleaGuilty1425',
						'Datum.TrialGuilty1425',
						'Datum.TrialNG1425',
						'Datum.Fines1425',
						'Datum.Sent1425',
						'Datum.Prob1425',

						'Datum.S1512',
						'Datum.Counts1512',
						'Datum.CountsNP1512',
						'Datum.PleaDismissed1512',
						'Datum.PleaGuilty1512',
						'Datum.TrialGuilty1512',
						'Datum.TrialNG1512',
						'Datum.Fines1512',
						'Datum.Sent1512',
						'Datum.Prob1512',

						'Datum.S1546',
						'Datum.Counts1546',
						'Datum.CountsNP1546',
						'Datum.PleaDismissed1546',
						'Datum.PleaGuilty1546',
						'Datum.TrialGuilty1546',
						'Datum.TrialNG1546',
						'Datum.Fines1546',
						'Datum.Sent1546',
						'Datum.Prob1546',
						
						'Datum.S1581to1588',
						'Datum.Counts1581to1588',
						'Datum.CountsNP1581to1588',
						'Datum.PleaDismissed1581to1588',
						'Datum.PleaGuilty1581to1588',
						'Datum.TrialGuilty1581to1588',
						'Datum.TrialNG1581to1588',
						'Datum.Fines1581to1588',
						'Datum.Sent1581to1588',
						'Datum.Prob1581to1588',
						
						'Datum.S1589',
						'Datum.Counts1589',
						'Datum.CountsNP1589',
						'Datum.PleaDismissed1589',
						'Datum.PleaGuilty1589',
						'Datum.TrialGuilty1589',
						'Datum.TrialNG1589',
						'Datum.Fines1589',
						'Datum.Sent1589',
						'Datum.Prob1589',
						
						'Datum.S1590',
						'Datum.Counts1590',
						'Datum.CountsNP1590',
						'Datum.PleaDismissed1590',
						'Datum.PleaGuilty1590',
						'Datum.TrialGuilty1590',
						'Datum.TrialNG1590',
						'Datum.Fines1590',
						'Datum.Sent1590',
						'Datum.Prob1590',
						
						'Datum.S1591',
						'Datum.Counts1591',
						'Datum.CountsNP1591',
						'Datum.PleaDismissed1591',
						'Datum.PleaGuilty1591',
						'Datum.TrialGuilty1591',
						'Datum.TrialNG1591',
						'Datum.Fines1591',
						'Datum.Sent1591',
						'Datum.Prob1591',
						
						'Datum.S1592',
						'Datum.Counts1592',
						'Datum.CountsNP1592',
						'Datum.PleaDismissed1592',
						'Datum.PleaGuilty1592',
						'Datum.TrialGuilty1592',
						'Datum.TrialNG1592',
						'Datum.Fines1592',
						'Datum.Sent1592',
						'Datum.Prob1592',
						
						'Datum.S2252',
						'Datum.Counts2252',
						'Datum.CountsNP2252',
						'Datum.PleaDismissed2252',
						'Datum.PleaGuilty2252',
						'Datum.TrialGuilty2252',
						'Datum.TrialNG2252',
						'Datum.Fines2252',
						'Datum.Sent2252',
						'Datum.Prob2252',
						
						'Datum.S2260',
						'Datum.Counts2260',
						'Datum.CountsNP2260',
						'Datum.PleaDismissed2260',
						'Datum.PleaGuilty2260',
						'Datum.TrialGuilty2260',
						'Datum.TrialNG2260',
						'Datum.Fines2260',
						'Datum.Sent2260',
						'Datum.Prob2260',
						
						'Datum.S2421to2424',
						'Datum.Counts2421to2424',
						'Datum.CountsNP2421to2424',
						'Datum.PleaDismissed2421to2424',
						'Datum.PleaGuilty2421to2424',
						'Datum.TrialGuilty2421to2424',
						'Datum.TrialNG2421to2424',
						'Datum.Fines2421to2424',
						'Datum.Sent2421to2424',
						'Datum.Prob2421to2424',
						
						'Datum.S1324',
						'Datum.Counts1324',
						'Datum.CountsNP1324',
						'Datum.PleaDismissed1324',
						'Datum.PleaGuilty1324',
						'Datum.TrialGuilty1324',
						'Datum.TrialNG1324',
						'Datum.Fines1324',
						'Datum.Sent1324',
						'Datum.Prob1324',
						
						'Datum.S1328',
						'Datum.Counts1328',
						'Datum.CountsNP1328',
						'Datum.PleaDismissed1328',
						'Datum.PleaGuilty1328',
						'Datum.TrialGuilty1328',
						'Datum.TrialNG1328',
						'Datum.Fines1328',
						'Datum.Sent1328',
						'Datum.Prob1328',

						'Datum.DateTerm',
						'Datum.SentDate',
						'Datum.TotalSentence',
						'Datum.Restitution',
						'Datum.AssetForfeit',
						'Datum.SupRelease',
						'Datum.Probation',
						'Datum.NumVic',
						'Datum.NumVicMinor',
						'Datum.NumVicForeign',
						'Datum.NumVicFemale',
						'Datum.OCName1',
						'Datum.OCType1',
						'Datum.OCRace1',
						'Datum.OCScope1',
						'Datum.OCName2',
						'Datum.OCType2',
						'Datum.OCRace2',
						'Datum.OCScope2'
					)
				)
			); //Grab all data from DB

			$ara = array(
								'CaseDefId' => 'CaseDefId',
								'Id' => 'Id',
								'DefLast' => 'DefLast',
								'DefFirst' => 'DefFirst' ,
								'Alias' => 'Alias',
								'CaseNam' => 'CaseNam' ,
								'CaseNum' => 'CaseNum' ,
								'NumDef' => 'NumDef',
								'State' => 'State',
								'FedDistrictLoc' => 'FedDistrictLoc',
								'FedDistrictNum' => 'FedDistrictNum',
								'JudgeName' => 'JudgeName',
								'JudgeRace' => 'JudgeRace',
								'JudgeGen' => 'JudgeGen',
								'JudgeTenure' => 'JudgeTenure',
								'JudgeApptBy' => 'JudgeApptBy',
								'CaseSummary' => 'CaseSummary',
								'DefGender' => 'DefGender',
								'DefRace' => 'DefRace',
								'DefBirthdate' => 'DefBirthdate',
								'DefArrestAge' => 'DefArrestAge',
								'ChargeDate' => 'ChargeDate',
								'ArrestDate' => 'ArrestDate',
								'Detained' => 'Detained',
								'BailType' => 'BailType',
								'BailAmount' => 'BailAmount',
								'LaborTraf' => 'LaborTraf',
								'AdultSexTraf' => 'AdultSexTraf',
								'MinorSexTraf' => 'MinorSexTraf',
								'FelCharged' => 'FelCharged',
								'FelSentenced' => 'FelSentenced',

								'1961to1968' => '1961to1968',
								'Counts1961to1968' => 'Counts1961to1968',
								'CountsNP1961to1968' => 'CountsNP1961to1968',
								'PleaDismissed1961to1968' => 'PleaDismissed1961to1968',
								'PleaGuilty1961to1968' => 'PleaGuilty1961to1968',
								'TrialGuilty1961to1968' => 'TrialGuilty1961to1968',
								'TrialNG1961to1968' => 'TrialNG1961to1968',
								'Fines1961to1968' => 'Fines1961to1968',
								'Sent1961to1968' => 'Sent1961to1968',
								'Prob1961to1968' => 'Prob1961to1968',

								'1028' => '1028',
								'Counts1028' => 'Counts1028',
								'CountsNP1028' => 'CountsNP1028',
								'PleaDismissed1028' => 'PleaDismissed1028',
								'PleaGuilty1028' => 'PleaGuilty1028',
								'TrialGuilty1028' => 'TrialGuilty1028',
								'TrialNG1028' => 'TrialNG1028',
								'Fines1028' => 'Fines1028',
								'Sent1028' => 'Sent1028',
								'Prob1028' => 'Prob1028',

								'1351' => '1351',
								'Counts1351' => 'Counts1351',
								'CountsNP1351' => 'CountsNP1351',
								'PleaDismissed1351' => 'PleaDismissed1351',
								'PleaGuilty1351' => 'PleaGuilty1351',
								'TrialGuilty1351' => 'TrialGuilty1351',
								'TrialNG1351' => 'TrialNG1351',
								'Fines1351' => 'Fines1351',
								'Sent1351' => 'Sent1351',
								'Prob1351' => 'Prob1351',

								'1425' => '1425',
								'Counts1425' => 'Counts1425',
								'CountsNP1425' => 'CountsNP1425',
								'PleaDismissed1425' => 'PleaDismissed1425',
								'PleaGuilty1425' => 'PleaGuilty1425',
								'TrialGuilty1425' => 'TrialGuilty1425',
								'TrialNG1425' => 'TrialNG1425',
								'Fines1425' => 'Fines1425',
								'Sent1425' => 'Sent1425',
								'Prob1425' => 'Prob1425',

								'1512' => '1512',
								'Counts1512' => 'Counts1512',
								'CountsNP1512' => 'CountsNP1512',
								'PleaDismissed1512' => 'PleaDismissed1512',
								'PleaGuilty1512' => 'PleaGuilty1512',
								'TrialGuilty1512' => 'TrialGuilty1512',
								'TrialNG1512' => 'TrialNG1512',
								'Fines1512' => 'Fines1512',
								'Sent1512' => 'Sent1512',
								'Prob1512' => 'Prob1512',

								'1546' => '1546',
								'Counts1546' => 'Counts1546',
								'CountsNP1546' => 'CountsNP1546',
								'PleaDismissed1546' => 'PleaDismissed1546',
								'PleaGuilty1546' => 'PleaGuilty1546',
								'TrialGuilty1546' => 'TrialGuilty1546',
								'TrialNG1546' => 'TrialNG1546',
								'Fines1546' => 'Fines1546',
								'Sent1546' => 'Sent1546',
								'Prob1546' => 'Prob1546',
								
								'1581to1588' => '1581to1588',
								'Counts1581to1588' => 'Counts1581to1588',
								'CountsNP1581to1588' => 'CountsNP1581to1588',
								'PleaDismissed1581to1588' => 'PleaDismissed1581to1588',
								'PleaGuilty1581to1588' => 'PleaGuilty1581to1588',
								'TrialGuilty1581to1588' => 'TrialGuilty1581to1588',
								'TrialNG1581to1588' => 'TrialNG1581to1588',
								'Fines1581to1588' => 'Fines1581to1588',
								'Sent1581to1588' => 'Sent1581to1588',
								'Prob1581to1588' => 'Prob1581to1588',
								
								'1589' => '1589',
								'Counts1589' => 'Counts1589',
								'CountsNP1589' => 'CountsNP1589',
								'PleaDismissed1589' => 'PleaDismissed1589',
								'PleaGuilty1589' => 'PleaGuilty1589',
								'TrialGuilty1589' => 'TrialGuilty1589',
								'TrialNG1589' => 'TrialNG1589',
								'Fines1589' => 'Fines1589',
								'Sent1589' => 'Sent1589',
								'Prob1589' => 'Prob1589',
								
								'1590' => '1590',
								'Counts1590' => 'Counts1590',
								'CountsNP1590' => 'CountsNP1590',
								'PleaDismissed1590' => 'PleaDismissed1590',
								'PleaGuilty1590' => 'PleaGuilty1590',
								'TrialGuilty1590' => 'TrialGuilty1590',
								'TrialNG1590' => 'TrialNG1590',
								'Fines1590' => 'Fines1590',
								'Sent1590' => 'Sent1590',
								'Prob1590' => 'Prob1590',
								
								'1591' => '1591',
								'Counts1591' => 'Counts1591',
								'CountsNP1591' => 'CountsNP1591',
								'PleaDismissed1591' => 'PleaDismissed1591',
								'PleaGuilty1591' => 'PleaGuilty1591',
								'TrialGuilty1591' => 'TrialGuilty1591',
								'TrialNG1591' => 'TrialNG1591',
								'Fines1591' => 'Fines1591',
								'Sent1591' => 'Sent1591',
								'Prob1591' => 'Prob1591',
								
								'1592' => '1592',
								'Counts1592' => 'Counts1592',
								'CountsNP1592' => 'CountsNP1592',
								'PleaDismissed1592' => 'PleaDismissed1592',
								'PleaGuilty1592' => 'PleaGuilty1592',
								'TrialGuilty1592' => 'TrialGuilty1592',
								'TrialNG1592' => 'TrialNG1592',
								'Fines1592' => 'Fines1592',
								'Sent1592' => 'Sent1592',
								'Prob1592' => 'Prob1592',
								
								'2252' => '2252',
								'Counts2252' => 'Counts2252',
								'CountsNP2252' => 'CountsNP2252',
								'PleaDismissed2252' => 'PleaDismissed2252',
								'PleaGuilty2252' => 'PleaGuilty2252',
								'TrialGuilty2252' => 'TrialGuilty2252',
								'TrialNG2252' => 'TrialNG2252',
								'Fines2252' => 'Fines2252',
								'Sent2252' => 'Sent2252',
								'Prob2252' => 'Prob2252',
								
								'2260' => '2260',
								'Counts2260' => 'Counts2260',
								'CountsNP2260' => 'CountsNP2260',
								'PleaDismissed2260' => 'PleaDismissed2260',
								'PleaGuilty2260' => 'PleaGuilty2260',
								'TrialGuilty2260' => 'TrialGuilty2260',
								'TrialNG2260' => 'TrialNG2260',
								'Fines2260' => 'Fines2260',
								'Sent2260' => 'Sent2260',
								'Prob2260' => 'Prob2260',
								
								'2421to2424' => '2421to2424',
								'Counts2421to2424' => 'Counts2421to2424',
								'CountsNP2421to2424' => 'CountsNP2421to2424',
								'PleaDismissed2421to2424' => 'PleaDismissed2421to2424',
								'PleaGuilty2421to2424' => 'PleaGuilty2421to2424',
								'TrialGuilty2421to2424' => 'TrialGuilty2421to2424',
								'TrialNG2421to2424' => 'TrialNG2421to2424',
								'Fines2421to2424' => 'Fines2421to2424',
								'Sent2421to2424' => 'Sent2421to2424',
								'Prob2421to2424' => 'Prob2421to2424',
								
								'1324' => '1324',
								'Counts1324' => 'Counts1324',
								'CountsNP1324' => 'CountsNP1324',
								'PleaDismissed1324' => 'PleaDismissed1324',
								'PleaGuilty1324' => 'PleaGuilty1324',
								'TrialGuilty1324' => 'TrialGuilty1324',
								'TrialNG1324' => 'TrialNG1324',
								'Fines1324' => 'Fines1324',
								'Sent1324' => 'Sent1324',
								'Prob1324' => 'Prob1324',
								
								'1328' => '1328',
								'Counts1328' => 'Counts1328',
								'CountsNP1328' => 'CountsNP1328',
								'PleaDismissed1328' => 'PleaDismissed1328',
								'PleaGuilty1328' => 'PleaGuilty1328',
								'TrialGuilty1328' => 'TrialGuilty1328',
								'TrialNG1328' => 'TrialNG1328',
								'Fines1328' => 'Fines1328',
								'Sent1328' => 'Sent1328',
								'Prob1328' => 'Prob1328',

								'DateTerm' => 'DateTerm',
								'SentDate' => 'SentDate',
								'TotalSentence' => 'TotalSentence',
								'Restitution' => 'Restitution',
								'AssetForfeit' => 'AssetForfeit',
								'SupRelease' => 'SupRelease',
								'Probation' => 'Probation',
								'NumVic' => 'NumVic',
								'NumVicMinor' => 'NumVicMinor',
								'NumVicForeign' => 'NumVicForeign',
								'NumVicFemale' => 'NumVicFemale',
								'OCName1' => 'OCName1',
								'OCType1' => 'OCType1',
								'OCRace1' => 'OCRace1',
								'OCScope1' => 'OCScope1',
								'OCName2' => 'OCName2',
								'OCType2' => 'OCType2',
								'OCRace2' => 'OCRace2',
								'OCScope2' => 'OCScope2'
			);

			if (count($allData) > 0) {
			// prepare the file and name it docket.csv
			$fp = fopen('docketDownload.csv', 'w+');

			fputcsv($fp, $ara); //adds the column labels 
				// Save data

				$statutes = ['1961to1968', '1028', '1351',
						'1425', '1512', '1546', '1581to1588', '1589',
						'1590', '1591', '1592', '2252', '2260', '2421to2424',
						'1324', '1328'];		

				foreach ($allData as $row) {

					//Filters to compensate for CakePHP pulling 
					//booleans with 0 value out as "false."
					if (isset($row['Datum']['JudgeGen']) && $row['Datum']['JudgeGen'] == false) {
						$row['Datum']['JudgeGen'] = '0';
					}
					if (isset($row['Datum']['DefGender']) && $row['Datum']['DefGender'] == false) {
						$row['Datum']['DefGender'] = '0';
					}
					if (isset($row['Datum']['JudgeApptBy']) && $row['Datum']['JudgeApptBy'] == false) {
						$row['Datum']['JudgeApptBy'] = '0';
					}
					if (isset($row['Datum']['Detained']) && $row['Datum']['Detained'] == false) {
						$row['Datum']['Detained'] = '0';
					}
					if (isset($row['Datum']['LaborTraf']) && $row['Datum']['LaborTraf'] == false) {
						$row['Datum']['LaborTraf'] = '0';
					}
					if (isset($row['Datum']['AdultSexTraf']) && $row['Datum']['AdultSexTraf'] == false) {
						$row['Datum']['AdultSexTraf'] ='0';
					}
					if (isset($row['Datum']['MinorSexTraf']) && $row['Datum']['MinorSexTraf'] == false) {
						$row['Datum']['MinorSexTraf'] = '0';
					}
					if (isset($row['Datum']['AssetForfeit']) && $row['Datum']['AssetForfeit'] == false) {
						$row['Datum']['AssetForfeit'] = '0';
					}
					foreach ($statutes as $statute) {
						if (isset($row['Datum']["S$statute"]) && $row['Datum']["S$statute"] == false) {
							$row['Datum']["S$statute"] = '0';
						}
					}
					// foreach($row['Datum'] as $val) {
					// 	echo $val . ', ';
					// }
					fputcsv($fp, $row['Datum']);
				}
				fclose($fp); //close the file
			}

			$file = 'docketDownload.csv';

		/**** Download File ****/	
			if(!$file){ // file does not exist
				die('file not found');
			} else {
				header("Cache-Control: public");
				header("Content-Description: File Transfer");
				header("Content-Disposition: attachment; filename=$file");
				header("Content-Type: application/zip");
				header("Content-Transfer-Encoding: binary");
				// read the file from disk
				readfile($file);
			}
			exit(); //kills (die) the execution and will not add html
		}
				
	}
	
}